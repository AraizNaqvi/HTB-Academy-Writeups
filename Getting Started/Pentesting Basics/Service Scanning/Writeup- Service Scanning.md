

We are to get flags to the following tasks:

Q1: Perform an Nmap scan of the target. What does Nmap display as the version of the service running on port 8080?
Q2: Perform an Nmap scan of the target and identify the non-default port that the telnet service is running on.
Q3: List the SMB shares available on the target host. Connect to the available share as the bob user. Once connected, access the folder called 'flag' and submit the contents of the flag.txt file.

**Answers**:

Let's first see what shares are available:
```
$ smbclient -N -L \\\\10.129.48.130

	Sharename       Type      Comment
	---------       ----      -------
	print$          Disk      Printer Drivers
	users           Disk      
	IPC$            IPC       IPC Service (gs-svcscan server (Samba, Ubuntu))
SMB1 disabled -- no workgroup available
```

Let's jump into `users`:
```
$ smbclient \\\\10.129.48.130\\users
Password for [WORKGROUP\alice]:
Try "help" to get a list of possible commands.
smb: \> ls
NT_STATUS_ACCESS_DENIED listing \*
smb: \> exit
```

As said before, there's almost no permissions given to no sign-ins.
So, let's go ahead and use credentials `bob:Welcome1`:
```
$ smbclient -U bob \\\\10.129.48.130\\users
Password for [WORKGROUP\bob]:
Try "help" to get a list of possible commands.
smb: \>
```

Listing out all contents and using `get` to get those files:
```
smb: \> ls
  .                                   D        0  Fri Feb 26 04:36:52 2021
  ..                                  D        0  Fri Feb 26 01:35:31 2021
  flag                                D        0  Fri Feb 26 04:39:26 2021
  bob                                 D        0  Fri Feb 26 03:12:23 2021

		4062912 blocks of size 1024. 1276096 blocks available
smb: \> ls flag
  flag                                D        0  Fri Feb 26 04:39:26 2021

		4062912 blocks of size 1024. 1276096 blocks available
smb: \> cd flag
smb: \flag\> ls
  .                                   D        0  Fri Feb 26 04:39:26 2021
  ..                                  D        0  Fri Feb 26 04:36:52 2021
  flag.txt                            N       33  Fri Feb 26 04:39:26 2021
get fl
		4062912 blocks of size 1024. 1276096 blocks available
smb: \flag\> get flag.txt
getting file \flag\flag.txt of size 33 as flag.txt (0.0 KiloBytes/sec) (average 0.0 KiloBytes/sec)
smb: \flag\> cd ..
smb: \> ls
  .                                   D        0  Fri Feb 26 04:36:52 2021
  ..                                  D        0  Fri Feb 26 01:35:31 2021
  flag                                D        0  Fri Feb 26 04:39:26 2021
  bob                                 D        0  Fri Feb 26 03:12:23 2021
cd bob
		4062912 blocks of size 1024. 1276096 blocks available
smb: \> cd bob
smb: \bob\> ls
  .                                   D        0  Fri Feb 26 03:12:23 2021
  ..                                  D        0  Fri Feb 26 04:36:52 2021
  passwords.txt                       N      156  Fri Feb 26 03:12:23 2021

		4062912 blocks of size 1024. 1276096 blocks available
smb: \bob\> get passwords.txt 
getting file \bob\passwords.txt of size 156 as passwords.txt (0.1 KiloBytes/sec) (average 0.1 KiloBytes/sec)
smb: \bob\> exit

```

The `flag` looked like it would be asked later ;) but there's a `bob` folder which contained essential passwords.
```
$ cat flag.txt
dceece590f3284c3866305eb2473d099
```

A3: `dceece590f3284c3866305eb2473d099`

In order to scan the version of service used on port `8080`:
```
$ nmap -sV -p8080 10.129.48.130
Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-01-02 11:55 IST
Nmap scan report for 10.129.48.130
Host is up (0.41s latency).

PORT     STATE SERVICE VERSION
8080/tcp open  http    Apache Tomcat

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 10.60 seconds

```

A1: `Apache Tomcat`

To get the services, let's do a simple service version scan:
```
$ sudo nmap -sV 10.129.48.130
[sudo] password for alice: 
Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-01-02 12:03 IST
Stats: 0:00:05 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan
SYN Stealth Scan Timing: About 32.45% done; ETC: 12:03 (0:00:10 remaining)
Nmap scan report for 10.129.48.130
Host is up (0.31s latency).
Not shown: 993 closed tcp ports (reset)
PORT     STATE SERVICE     VERSION
21/tcp   open  ftp         vsftpd 3.0.3
22/tcp   open  ssh         OpenSSH 8.2p1 Ubuntu 4ubuntu0.1 (Ubuntu Linux; protocol 2.0)
80/tcp   open  http        Apache httpd 2.4.41 ((Ubuntu))
139/tcp  open  netbios-ssn Samba smbd 4.6.2
445/tcp  open  netbios-ssn Samba smbd 4.6.2
2323/tcp open  telnet      Linux telnetd
8080/tcp open  http        Apache Tomcat
Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 30.88 seconds

```

Clearly, telnet is running on `2323`

A2: `2323`